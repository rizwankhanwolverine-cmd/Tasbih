<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Sanctuary Infinity</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #C2B280; --vanta: #050508; --white: #FFFFFF; --dark-grey: #121214; }
        * { -webkit-tap-highlight-color: transparent; outline: none; box-sizing: border-box; }

        body { 
            background-color: var(--vanta); color: var(--gold); 
            font-family: -apple-system, system-ui, sans-serif; 
            margin: 0; padding: 0; overflow: hidden; height: 100vh;
            display: flex; flex-direction: column;
        }

        /* PAGE SYSTEM */
        .page { display: none; flex-direction: column; align-items: center; height: calc(100vh - 85px); width: 100%; padding: 20px; overflow-y: auto; }
        .active-page { display: flex; }
        .header-title { letter-spacing: 5px; font-weight: 200; text-transform: uppercase; margin-bottom: 25px; text-align: center; font-size: 1.1rem; }

        /* --- TASBIH UI (RESTORED) --- */
        .tasbih-circle { 
            width: 250px; height: 250px; border-radius: 50%; border: 1px solid rgba(194,178,128,0.3); 
            display: flex; flex-direction: column; justify-content: center; align-items: center; 
            position: relative; cursor: pointer; background: radial-gradient(circle, #101012 0%, #050508 100%);
        }
        .count-num { font-size: 5rem; color: var(--white); font-weight: 100; margin: 0; }

        /* --- SALAH LOG UI (RESTORED) --- */
        .salah-list { width: 100%; max-width: 350px; display: flex; flex-direction: column; gap: 12px; }
        .salah-card { 
            background: var(--dark-grey); padding: 18px; border-radius: 12px; 
            display: flex; justify-content: space-between; align-items: center;
            border: 1px solid rgba(194,178,128,0.1);
        }
        .salah-card.completed { border-color: var(--gold); background: rgba(194,178,128,0.05); }
        .check-box { width: 22px; height: 22px; border: 1px solid var(--gold); border-radius: 4px; display: flex; align-items: center; justify-content: center; }
        .check-box.checked::after { content: 'âœ“'; color: var(--gold); }

        /* --- REVELATION UI --- */
        .quran-container { width: 100%; max-width: 400px; display: flex; flex-direction: column; gap: 10px; }
        .selector { background: var(--dark-grey); color: var(--gold); border: 1px solid rgba(194,178,128,0.2); padding: 10px; border-radius: 10px; font-size: 0.8rem; width: 100%; }
        .reader-frame { 
            background: #0a0a0c; padding: 30px 20px; border-radius: 25px; text-align: center;
            border: 1px solid rgba(194, 178, 128, 0.1); min-height: 300px;
        }
        .arabic-text { font-family: 'Amiri', serif; font-size: 1.8rem; line-height: 1.8; color: var(--white); direction: rtl; }

        /* NAV BAR */
        .nav-bar { height: 85px; background: #08080a; border-top: 1px solid rgba(194, 178, 128, 0.1); display: flex; justify-content: space-around; align-items: center; padding-bottom: env(safe-area-inset-bottom); }
        .nav-item { display: flex; flex-direction: column; align-items: center; opacity: 0.3; flex: 1; cursor: pointer; }
        .nav-item.active { opacity: 1; }
        .nav-label { font-size: 0.5rem; letter-spacing: 1px; text-transform: uppercase; margin-top: 4px; }
    </style>
</head>
<body>

    <div id="page-tasbih" class="page active-page">
        <h1 class="header-title">Tasbih</h1>
        <div class="tasbih-circle" onclick="doTap()">
            <p id="tCount" class="count-num">0</p>
            <p style="font-size:0.6rem; letter-spacing:2px; opacity:0.5;">TAP TO PRAY</p>
        </div>
        <button onclick="count = 0; updateUI();" style="margin-top:30px; background:none; border:1px solid rgba(255,255,255,0.1); color:var(--gold); padding:8px 25px; border-radius:20px; font-size:0.7rem;">RESET</button>
    </div>

    <div id="page-quran" class="page">
        <h1 class="header-title">The Revelation</h1>
        <div class="quran-container">
            <select id="surahSelect" class="selector" onchange="initSurah()">
                <option value="1">1. Al-Fatiha</option>
                <option value="112">112. Al-Ikhlas</option>
                <option value="114">114. Al-Nas</option>
            </select>
            <div class="reader-frame">
                <div id="v-num" style="font-size:0.6rem; opacity:0.4; margin-bottom:10px;">AYAH 1</div>
                <div id="q-arabic" class="arabic-text">...</div>
                <div id="q-trans" style="font-size:0.9rem; opacity:0.7; margin-top:15px;">...</div>
                
                <div style="display:flex; justify-content:space-around; align-items:center; margin-top:30px;">
                    <button onclick="prevVerse()" style="background:none; border:none; fill:var(--gold);"><svg width="30" viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg></button>
                    <button id="playBtn" onclick="toggleAudio()" style="width:60px; height:60px; border-radius:50%; background:var(--gold); border:none; display:flex; justify-content:center; align-items:center;">
                        <svg id="playIcon" width="30" viewBox="0 0 24 24"><path d="M8,5.14V19.14L19,12.14L8,5.14Z"/></svg>
                    </button>
                    <button onclick="nextVerse()" style="background:none; border:none; fill:var(--gold);"><svg width="30" viewBox="0 0 24 24"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg></button>
                </div>
            </div>
        </div>
    </div>

    <div id="page-salah" class="page">
        <h1 class="header-title">Salah Log</h1>
        <div class="salah-list">
            <div class="salah-card" onclick="this.classList.toggle('completed'); this.querySelector('.check-box').classList.toggle('checked');">
                <span>Fajr</span> <div class="check-box"></div>
            </div>
            <div class="salah-card" onclick="this.classList.toggle('completed'); this.querySelector('.check-box').classList.toggle('checked');">
                <span>Dhuhr</span> <div class="check-box"></div>
            </div>
            <div class="salah-card" onclick="this.classList.toggle('completed'); this.querySelector('.check-box').classList.toggle('checked');">
                <span>Asr</span> <div class="check-box"></div>
            </div>
            <div class="salah-card" onclick="this.classList.toggle('completed'); this.querySelector('.check-box').classList.toggle('checked');">
                <span>Maghrib</span> <div class="check-box"></div>
            </div>
            <div class="salah-card" onclick="this.classList.toggle('completed'); this.querySelector('.check-box').classList.toggle('checked');">
                <span>Isha</span> <div class="check-box"></div>
            </div>
        </div>
    </div>

    <div class="nav-bar">
        <div id="nav-tasbih" class="nav-item active" onclick="switchPage('tasbih')"><span class="nav-label">Tasbih</span></div>
        <div id="nav-quran" class="nav-item" onclick="switchPage('quran')"><span class="nav-label">Listen</span></div>
        <div id="nav-salah" class="nav-item" onclick="switchPage('salah')"><span class="nav-label">Salah</span></div>
    </div>

    <audio id="mainAudio" onended="nextVerse()"></audio>

    <script>
        // TASBIH
        let count = 0;
        const tapSfx = new Audio('https://www.soundjay.com/buttons/button-16.mp3');
        function doTap() {
            count++;
            tapSfx.play().catch(()=>{});
            if (window.navigator.vibrate) window.navigator.vibrate(50);
            updateUI();
        }
        function updateUI() { document.getElementById('tCount').textContent = count; }

        // REVELATION
        let currentVerse = 1; let verseData = [];
        const audio = document.getElementById('mainAudio');

        async function initSurah() {
            const id = document.getElementById('surahSelect').value;
            const resAr = await fetch(`https://api.alquran.cloud/v1/surah/${id}`);
            const resEn = await fetch(`https://api.alquran.cloud/v1/surah/${id}/en.sahih`);
            const dAr = await resAr.json(); const dEn = await resEn.json();
            verseData = dAr.data.ayahs.map((a, i) => ({
                ar: a.text, en: dEn.data.ayahs[i].text,
                audio: `https://cdn.islamic.network/quran/audio/128/ar.alafasy/${a.number}.mp3`
            }));
            currentVerse = 1; updateVerseUI();
        }

        function updateVerseUI() {
            const v = verseData[currentVerse - 1];
            document.getElementById('q-arabic').textContent = v.ar;
            document.getElementById('q-trans').textContent = v.en;
            document.getElementById('v-num').textContent = `AYAH ${currentVerse} / ${verseData.length}`;
            audio.src = v.audio;
        }

        function toggleAudio() {
            if (audio.paused) { audio.play(); document.getElementById('playIcon').innerHTML = '<path d="M14,19H18V5H14M6,19H10V5H6V19Z"/>'; }
            else { audio.pause(); document.getElementById('playIcon').innerHTML = '<path d="M8,5.14V19.14L19,12.14L8,5.14Z"/>'; }
        }

        function nextVerse() { if(currentVerse < verseData.length) { currentVerse++; updateVerseUI(); audio.play(); } }
        function prevVerse() { if(currentVerse > 1) { currentVerse--; updateVerseUI(); audio.play(); } }

        function switchPage(p) {
            document.querySelectorAll('.page').forEach(pg => pg.classList.remove('active-page'));
            document.querySelectorAll('.nav-item').forEach(ni => ni.classList.remove('active'));
            document.getElementById('page-' + p).classList.add('active-page');
            document.getElementById('nav-' + p).classList.add('active');
            audio.pause();
        }

        initSurah();
    </script>
</body>
</html>
