<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#050508">
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <title>Sanctuary Infinity</title>
    <style>
        :root { --gold: #C2B280; --vanta: #050508; --white: #FFFFFF; --dark-grey: #121214; }
        * { -webkit-tap-highlight-color: transparent; outline: none; box-sizing: border-box; }

        body { 
            background-color: var(--vanta); color: var(--gold); 
            font-family: -apple-system, system-ui, sans-serif; 
            margin: 0; padding: 0; overflow: hidden; height: 100vh;
            display: flex; flex-direction: column;
        }

        .page { display: none; flex-direction: column; align-items: center; height: calc(100vh - 85px); width: 100%; padding: 20px; overflow-y: auto; }
        .active-page { display: flex; }

        .header-title { letter-spacing: 5px; font-weight: 200; text-transform: uppercase; margin-bottom: 20px; text-align: center; font-size: 1.2rem; }
        
        /* QURAN SPECIFIC STYLES */
        .quran-container { width: 100%; max-width: 400px; display: flex; flex-direction: column; gap: 20px; }
        .surah-picker { background: var(--dark-grey); color: var(--gold); border: 1px solid rgba(194, 178, 128, 0.2); padding: 12px; border-radius: 12px; width: 100%; font-size: 0.9rem; letter-spacing: 1px; }
        
        .reader-frame { 
            background: #0a0a0c; padding: 35px 25px; border-radius: 25px; 
            text-align: center; border: 1px solid rgba(194, 178, 128, 0.1);
            min-height: 300px; display: flex; flex-direction: column; justify-content: center;
        }
        .arabic-text { 
            font-family: "Amiri", serif; font-size: 2.2rem; line-height: 2.5; 
            color: var(--white); direction: rtl; margin-bottom: 20px;
        }
        .translation-text { font-size: 0.9rem; color: var(--gold); opacity: 0.6; font-style: italic; line-height: 1.6; }

        /* REUSABLE UI */
        .circle { width: 200px; height: 200px; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 5rem; background: radial-gradient(circle, #1a1a1a 0%, var(--vanta) 100%); box-shadow: inset 0 0 40px #000; }
        .salah-card { background: var(--dark-grey); margin: 8px 0; padding: 18px; border-radius: 12px; border: 1px solid rgba(194, 178, 128, 0.05); display: flex; justify-content: center; align-items: center; width: 100%; max-width: 320px; }
        .salah-card.lit { background: rgba(194, 178, 128, 0.15); border: 1px solid var(--gold); }
        
        /* NAV BAR */
        .nav-bar { height: 85px; background: #08080a; border-top: 1px solid rgba(194, 178, 128, 0.1); display: flex; justify-content: space-around; align-items: center; padding-bottom: env(safe-area-inset-bottom); }
        .nav-item { display: flex; flex-direction: column; align-items: center; justify-content: center; width: 25%; height: 100%; opacity: 0.25; transition: 0.4s; }
        .nav-item.active { opacity: 1; }
        .nav-icon-svg { width: 26px; height: 26px; fill: var(--gold); margin-bottom: 4px; }
        .nav-label { font-size: 0.55rem; letter-spacing: 1px; text-transform: uppercase; font-weight: 600; }
    </style>
</head>
<body>

    <div id="page-tasbih" class="page active-page" onclick="handleTasbihTap(event)">
        <div style="font-size:0.75rem; letter-spacing:3px; opacity:0.6;">DAILY: <span id="todayNum">0</span></div>
        <h1 class="header-title">Tasbih</h1>
        <div style="position:relative; width:280px; height:280px; display:flex; justify-content:center; align-items:center;">
            <svg width="280" height="280" style="position:absolute; transform:rotate(-90deg);">
                <circle stroke="rgba(194,178,128,0.05)" stroke-width="4" fill="transparent" r="125" cx="140" cy="140"/>
                <circle id="ring" stroke-width="6" fill="transparent" r="125" cx="140" cy="140" style="transition:0.3s; stroke:var(--gold); stroke-linecap:round;"/>
            </svg>
            <div class="circle"><span id="num">0</span></div>
        </div>
    </div>

    <div id="page-salah" class="page">
        <h1 class="header-title">Salah Log</h1>
        <div class="salah-card" onclick="toggleSalah('fajr')">FAJR</div>
        <div class="salah-card" onclick="toggleSalah('dhuhr')">DHUHR</div>
        <div class="salah-card" onclick="toggleSalah('asr')">ASR</div>
        <div class="salah-card" onclick="toggleSalah('maghrib')">MAGHRIB</div>
        <div class="salah-card" onclick="toggleSalah('isha')">ISHA</div>
    </div>

    <div id="page-quran" class="page">
        <h1 class="header-title">Quran</h1>
        <div class="quran-container">
            <select id="surahSelect" class="surah-picker" onchange="loadSurah()">
                <option value="fatiha">Al-Fatiha (The Opening)</option>
                <option value="ikhlas">Al-Ikhlas (Purity)</option>
                <option value="asr">Al-Asr (The Time)</option>
                <option value="kawthar">Al-Kawthar (Abundance)</option>
            </select>
            
            <div class="reader-frame">
                <div id="quran-arabic" class="arabic-text">بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ</div>
                <div id="quran-trans" class="translation-text">In the name of Allah, the Entirely Merciful, the Especially Merciful.</div>
            </div>
            <p style="text-align:center; font-size:0.6rem; opacity:0.4; letter-spacing:2px;">LAST READ SAVED AUTOMATICALLY</p>
        </div>
    </div>

    <div id="page-dash" class="page">
        <h1 class="header-title">Dashboard</h1>
        <div style="background:var(--dark-grey); padding:30px; border-radius:20px; text-align:center; width:100%; max-width:300px;">
            <div style="font-size:2rem; color:var(--white);" id="dash-tasbih">0</div>
            <div style="font-size:0.6rem; opacity:0.5; letter-spacing:2px;">TOTAL DHIKR</div>
        </div>
    </div>

    <div class="nav-bar">
        <div id="nav-tasbih" class="nav-item active" onclick="switchPage('tasbih')">
            <svg class="nav-icon-svg" viewBox="0 0 24 24"><path d="M12,2A3,3 0 0,1 15,5A3,3 0 0,1 12,8A3,3 0 0,1 9,5A3,3 0 0,1 12,2M12,16A3,3 0 0,1 15,19A3,3 0 0,1 12,22A3,3 0 0,1 9,19A3,3 0 0,1 12,16M18,8A3,3 0 0,1 21,11A3,3 0 0,1 18,14A3,3 0 0,1 15,11A3,3 0 0,1 18,8M6,8A3,3 0 0,1 9,11A3,3 0 0,1 6,14A3,3 0 0,1 3,11A3,3 0 0,1 6,8Z"/></svg>
            <span class="nav-label">Beads</span>
        </div>
        <div id="nav-salah" class="nav-item" onclick="switchPage('salah')">
            <svg class="nav-icon-svg" viewBox="0 0 24 24"><path d="M13,3A2,2 0 0,1 15,5A2,2 0 0,1 13,7A2,2 0 0,1 11,5A2,2 0 0,1 13,3M18.5,18.5L20,20H4L5,17L8.5,14L10,15L8,19H16L14,15L15,14L18.5,17.5V18.5Z"/></svg>
            <span class="nav-label">Salah</span>
        </div>
        <div id="nav-quran" class="nav-item" onclick="switchPage('quran')">
            <svg class="nav-icon-svg" viewBox="0 0 24 24"><path d="M12,11.5L19,7V18L12,22.5L5,18V7L12,11.5M12,2L19,6L12,10L5,6L12,2Z"/></svg>
            <span class="nav-label">Quran</span>
        </div>
        <div id="nav-dash" class="nav-item" onclick="switchPage('dash')">
            <svg class="nav-icon-svg" viewBox="0 0 24 24"><path d="M12,2L14.5,8.5L21,9.25L16.25,13.75L17.5,20.25L12,17.25L6.5,20.25L7.75,13.75L3,9.25L9.5,8.5L12,2M12,19V22H2V20H22V22H12V19Z"/></svg>
            <span class="nav-label">Journey</span>
        </div>
    </div>

    <script>
        const surahData = {
            fatiha: { ar: "الْحَمْدُ لِلَّهِ رَبِّ الْعَالَمِينَ", en: "All praise is due to Allah, Lord of the worlds." },
            ikhlas: { ar: "قُلْ هُوَ اللَّهُ أَحَدٌ", en: "Say, 'He is Allah, [who is] One.'" },
            asr: { ar: "وَالْعَصْرِ إِنَّ الْإِنْسَانَ لَفِي خُسْرٍ", en: "By time, indeed, mankind is in loss." },
            kawthar: { ar: "إِنَّا أَعْطَيْنَاكَ الْكَوْثَرَ", en: "Indeed, We have granted you, [O Muhammad], al-Kawthar." }
        };

        function loadSurah() {
            const val = document.getElementById('surahSelect').value;
            document.getElementById('quran-arabic').textContent = surahData[val].ar;
            document.getElementById('quran-trans').textContent = surahData[val].en;
            localStorage.setItem('lastSurah', val);
        }

        function switchPage(p) {
            document.querySelectorAll('.page').forEach(pg => pg.classList.remove('active-page'));
            document.querySelectorAll('.nav-item').forEach(ni => ni.classList.remove('active'));
            document.getElementById('page-' + p).classList.add('active-page');
            document.getElementById('nav-' + p).classList.add('active');
            updateUI();
        }

        function updateUI() {
            document.getElementById('num').textContent = localStorage.getItem('tasbihSession') || 0;
            document.getElementById('todayNum').textContent = localStorage.getItem('tasbihToday') || 0;
            document.getElementById('dash-tasbih').textContent = localStorage.getItem('tasbihToday') || 0;
            
            // Restore last surah read
            const savedSurah = localStorage.getItem('lastSurah');
            if(savedSurah) {
                document.getElementById('surahSelect').value = savedSurah;
                loadSurah();
            }
        }

        // Tasbih & Salah logic remains same as previous version
        function handleTasbihTap() {
            let s = parseInt(localStorage.getItem('tasbihSession') || 0) + 1;
            let t = parseInt(localStorage.getItem('tasbihToday') || 0) + 1;
            localStorage.setItem('tasbihSession', s);
            localStorage.setItem('tasbihToday', t);
            updateUI();
        }

        function toggleSalah(name) {
            const todayKey = "salah_" + new Date().toDateString();
            let state = JSON.parse(localStorage.getItem(todayKey)) || {};
            state[name] = !state[name];
            localStorage.setItem(todayKey, JSON.stringify(state));
            updateUI();
        }

        updateUI();
    </script>
</body>
</html>
